# Building the C# Windows Forms Activation Server GUI

This document provides instructions on how to set up the .NET projects and build the C# Windows Forms application using the `dotnet` CLI. You will need the .NET SDK installed (e.g., .NET 6 or later, as Windows Forms support in .NET Core/.NET 5+ is mature).

## Prerequisites

*   **.NET SDK:** (.NET 6 or newer recommended). You can download it from [dot.net](https://dot.net/download).
*   The C# source files generated by the AI assistant, organized in the `ActivationLogicLib` and `WindowsFormsApp` subdirectories.
*   The `activation_simulator.sqlite` database file (e.g., from `py_idevice_activation/data/`).

## Steps

1.  **Create a Solution Directory (Optional but Recommended):**
    Open your terminal or command prompt.
    ```bash
    mkdir CSharpActivationServer
    cd CSharpActivationServer
    # The AI generated files should be inside a 'windows_gui_tool' subdirectory here.
    # So, you might already have: CSharpActivationServer/windows_gui_tool/
    ```
    For the rest of these instructions, we'll assume your current directory is `CSharpActivationServer` (or whatever you named your top-level solution directory), and the AI-generated `windows_gui_tool` folder is inside it.

2.  **Create the Class Library Project (`ActivationLogicLib`):**
    This library will hold the core activation logic.
    ```bash
    # Navigate into where the AI placed the lib code, or create a new project and copy files
    # Assuming you are in CSharpActivationServer/
    dotnet new classlib -n ActivationLogicLib -o windows_gui_tool/ActivationLogicLib_proj
    # This creates a project folder named ActivationLogicLib_proj.
    # Now, copy the AI-generated .cs files into this new project folder:
    # FROM: windows_gui_tool/ActivationLogicLib/*.cs
    # TO:   windows_gui_tool/ActivationLogicLib_proj/
    #
    # Example (PowerShell):
    # copy windows_gui_tool/ActivationLogicLib/*.cs windows_gui_tool/ActivationLogicLib_proj/
    # Example (bash):
    # cp windows_gui_tool/ActivationLogicLib/*.cs windows_gui_tool/ActivationLogicLib_proj/
    #
    # Then, delete the default Class1.cs created by `dotnet new`.
    # Example (PowerShell):
    # remove-item windows_gui_tool/ActivationLogicLib_proj/Class1.cs
    # Example (bash):
    # rm windows_gui_tool/ActivationLogicLib_proj/Class1.cs
    ```
    *Manually ensure the `.csproj` file (`windows_gui_tool/ActivationLogicLib_proj/ActivationLogicLib.csproj`) correctly includes all `.cs` files if needed, though default globbing usually works.*

3.  **Create the Windows Forms Application Project (`WindowsFormsApp`):**
    ```bash
    # Assuming you are in CSharpActivationServer/
    dotnet new winforms -n WindowsFormsApp -o windows_gui_tool/WindowsFormsApp_proj
    # This creates a project folder named WindowsFormsApp_proj.
    # Copy the AI-generated .cs files for the WinForms app:
    # FROM: windows_gui_tool/WindowsFormsApp/*.cs
    # TO:   windows_gui_tool/WindowsFormsApp_proj/
    #
    # Example (PowerShell):
    # copy windows_gui_tool/WindowsFormsApp/*.cs windows_gui_tool/WindowsFormsApp_proj/
    # Example (bash):
    # cp windows_gui_tool/WindowsFormsApp/*.cs windows_gui_tool/WindowsFormsApp_proj/
    #
    # Delete the default Form1.cs, Form1.Designer.cs, and Program.cs (if different from AI's Program.cs)
    # Example (PowerShell):
    # remove-item windows_gui_tool/WindowsFormsApp_proj/Form1.*
    # (Be careful if your Program.cs from AI is also named Program.cs and you don't want to overwrite)
    # It's often easier to create the project, then open in an IDE and add/remove files.
    ```
    *The `MainForm.cs` provided by the AI includes programmatic UI setup. If you open this in Visual Studio, the designer might try to parse it or might show errors if the code-behind is not perfectly aligned with what it expects. Manual adjustments in the designer or code might be needed for complex UIs.*

4.  **Create a Solution File and Add Projects (Optional, but good practice):**
    ```bash
    # Assuming you are in CSharpActivationServer/
    dotnet new sln -n ActivationServerSolution
    dotnet sln ActivationServerSolution.sln add windows_gui_tool/ActivationLogicLib_proj/ActivationLogicLib.csproj
    dotnet sln ActivationServerSolution.sln add windows_gui_tool/WindowsFormsApp_proj/WindowsFormsApp.csproj
    ```

5.  **Add Project Reference:**
    The `WindowsFormsApp` needs to reference `ActivationLogicLib`.
    ```bash
    # Assuming you are in CSharpActivationServer/
    dotnet add windows_gui_tool/WindowsFormsApp_proj/WindowsFormsApp.csproj reference windows_gui_tool/ActivationLogicLib_proj/ActivationLogicLib.csproj
    ```

6.  **Add NuGet Packages:**
    Navigate to each project directory that needs packages and add them.
    *   **For `ActivationLogicLib_proj`:**
        ```bash
        cd windows_gui_tool/ActivationLogicLib_proj
        dotnet add package System.Data.SQLite.Core
        dotnet add package Newtonsoft.Json
        cd ../..
        # (or cd CSharpActivationServer/ if you started there)
        ```
    *   **For `WindowsFormsApp_proj`:** (May also need Newtonsoft.Json if directly used, though it's in the lib)
        ```bash
        cd windows_gui_tool/WindowsFormsApp_proj
        # If MainForm.cs directly uses Newtonsoft.Json (it does for error responses):
        dotnet add package Newtonsoft.Json
        # It will also get System.Data.SQLite.Core transitively if ActivationLogicLib uses it,
        # but direct add is fine if it uses it too.
        cd ../..
        ```

7.  **Prepare the Database:**
    *   Ensure the `activation_simulator.sqlite` file is accessible to the application.
    *   The `AppSettings.cs` tries to locate it. A common practice for Windows Forms apps is to place such data files in a `data` subdirectory next to the application's executable (`.exe`) file (e.g., in `windows_gui_tool/WindowsFormsApp_proj/bin/Debug/netX.X/data/`).
    *   You might need to set the "Copy to Output Directory" property for the SQLite file to "Copy if newer" or "Copy always" in your IDE if you add it to the project, or handle its deployment manually.
    *   For initial testing, you can manually copy `py_idevice_activation/data/activation_simulator.sqlite` to `windows_gui_tool/WindowsFormsApp_proj/bin/Debug/netX.X/data/activation_simulator.sqlite` (adjust `netX.X` to your .NET version, e.g., `net6.0-windows`).

8.  **Build the Solution/Project:**
    ```bash
    # Assuming you are in CSharpActivationServer/ (where the .sln file is)
    dotnet build ActivationServerSolution.sln
    # Or, build a specific project:
    # dotnet build windows_gui_tool/WindowsFormsApp_proj/WindowsFormsApp.csproj
    ```
    Address any compilation errors. These might arise from:
    *   Differences in .NET versions or available APIs.
    *   Typos or minor syntax issues in the AI-generated code.
    *   Missing using statements.
    *   Incorrect handling of the Windows Forms designer partial classes if you try to use the designer with the AI's `MainForm.cs`.

9.  **Run the Application:**
    ```bash
    # Assuming you are in CSharpActivationServer/
    dotnet run --project windows_gui_tool/WindowsFormsApp_proj/WindowsFormsApp.csproj
    # Or navigate to the output directory and run the .exe:
    # cd windows_gui_tool/WindowsFormsApp_proj/bin/Debug/netX.X/
    # ./WindowsFormsApp.exe (or WindowsFormsApp.exe on cmd)
    ```

This provides a command-line-centric way to set up and build. Using an IDE like Visual Studio can simplify steps 2, 3, 5, and 6 by managing project files and NuGet packages through its UI. The AI-generated code provides the logic, but integrating it into a fully buildable .NET project requires these tooling steps.
```
